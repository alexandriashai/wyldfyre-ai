# Grafana configuration for AI Infrastructure
# This enables SSO with the main web application via auth proxy

[server]
# Root URL for grafana.wyldfyre.ai (no subpath needed)
root_url = https://grafana.wyldfyre.ai/
serve_from_sub_path = false
domain = grafana.wyldfyre.ai

[security]
admin_user = admin
admin_password = ${GF_SECURITY_ADMIN_PASSWORD}
# Allow embedding in iframes from same origin
allow_embedding = true
cookie_samesite = lax

[users]
# Disable signup since we use auth proxy
allow_sign_up = false
auto_assign_org = true
auto_assign_org_role = Viewer

[auth]
# Disable login form when using auth proxy
disable_login_form = false
disable_signout_menu = false

[auth.anonymous]
# Allow anonymous access for basic dashboards
enabled = false

[auth.proxy]
# Enable auth proxy for SSO with web app
enabled = true
# Header containing the username/email
header_name = X-WEBAUTH-USER
# Header containing the user's email
header_property = email
# Auto sign up users that don't exist
auto_sign_up = true
# Sync teams from headers (optional)
# headers = Email:X-WEBAUTH-EMAIL Name:X-WEBAUTH-NAME
# Whitelist IPs that can set the header (localhost and docker network)
whitelist = 127.0.0.1, ::1, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16
# Enable sync of user details from headers
sync_ttl = 60
# Allow bypassing auth proxy for API calls
enable_login_token = true

[auth.basic]
# Keep basic auth enabled for API access
enabled = true

[log]
mode = console
level = info

[analytics]
reporting_enabled = false
check_for_updates = false

[dashboards]
# Version control for dashboards
versions_to_keep = 20

[unified_alerting]
enabled = true
